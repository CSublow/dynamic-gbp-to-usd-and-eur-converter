<!DOCTYPE html>
<html lang="en">
<head>
    <title>Dynamic Currency Conversion</title>
    <!-- Bootstrap -->
    <!-- Using Darkly Theme -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootswatch/4.1.3/darkly/bootstrap.min.css" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.1.1.slim.min.js" integrity="sha384-A7FZj7v+d/sdmMqp/nOQwliLvUsJfDHW+k9Omg/a/EheAdgtzNs3hpfag6Ed950n" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/style.css" type="text/css" />
</head>
<body>
    <nav class="navbar navbar-dark bg-dark">
        <h1>GBP to USD and EUR Currency Converter</h1>
    </nav>
    
    <main class="text-center">
        <form action="javascript:convert()">
            <label for="amount">Enter amount (&pound;) to convert</label>
            <span>&pound;</span><input type="text" id="amount"/>
            <input type="submit" value="Submit"/>
        </form>
        
        <div class="conversions">
            <!--<p>Amount to convert: <span id="ProductPrice">&pound;12.99</span></p>-->
            <p>US buyers:</p>
            <span id="USFX"></span>
            <p>European buyers:</p>
            <span id="EUFX"></span>
        </div>
    </main>
    
    <script src="js/jquery-3.2.1.min.js"></script>
    <script src="js/money.js"></script>
    <script type="text/javascript">
        // Load exchange rates data via AJAX:
        function convert() {
            $.getJSON(
            	// NB: using Open Exchange Rates here, but you can use any source!
                'https://openexchangerates.org/api/latest.json?app_id=49d329385faf437b9f7f75fbd5c5083d',
                function(data) {
                    // Check money.js has finished loading:
                    if ( typeof fx !== "undefined" && fx.rates ) {
                        fx.rates = data.rates;
                        fx.base = data.base;
                    } else {
                        // If not, apply to fxSetup global:
                        var fxSetup = {
                            rates : data.rates,
                            base : data.base
                        }
                    }
                //get the price of the product as a string
                var stringToConvert = $('#amount').val();
                    
                //find all characters except £
                var numb = stringToConvert.match(/[^£]/g);
                //join the numbers together
                numb = numb.join("");
                            
                //convert the string numbers into actual data type numbers
                var numb = Number(numb);
                
                //do the conversions
                var conversionUS = fx.convert(numb, {from: 'GBP', to: 'USD'});
                var conversionEU = fx.convert(numb, {from: 'GBP', to: 'EUR'});
                //round them to two decimal places
                var roundedConversionUS = parseFloat(Math.round(conversionUS * 100) / 100).toFixed(2);
                var roundedConversionEU = parseFloat(Math.round(conversionEU * 100) / 100).toFixed(2);
                            
                //print the conversion onto the page
                document.getElementById('USFX').innerHTML = '$' + roundedConversionUS;
                document.getElementById('EUFX').innerHTML = '&euro;' + roundedConversionEU;
                }
            );
        }
    </script>
</body>
</html>