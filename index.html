<!DOCTYPE html>
<html lang="en">
<head>
    <title>Dynamic Currency Conversion</title>
    <!-- Bootstrap -->
    <!-- Using Darkly Theme -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootswatch/4.1.3/darkly/bootstrap.min.css" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.1.1.slim.min.js" integrity="sha384-A7FZj7v+d/sdmMqp/nOQwliLvUsJfDHW+k9Omg/a/EheAdgtzNs3hpfag6Ed950n" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/style.css" type="text/css" />
</head>
<body>
    <nav class="navbar navbar-dark bg-dark">
        <h1>GBP to USD and EUR Currency Converter</h1>
    </nav>
    
    <main class="text-center">
        <form action="javascript:convert()">
            <label for="amount">Enter amount (&pound;) to convert</label>
            <span>&pound;</span><input type="number" id="amount"/>
            <input type="submit" value="Submit"/>
        </form>
        
        <p id="desc-p"><span id="amount-entered"></span> in today's exchange rate is:</p>
        
        <div class="conversions">
            <!--<p>Amount to convert: <span id="ProductPrice">&pound;12.99</span></p>-->
            <p id="usd">USD: <span id="USFX"></span></p>
            <p id="eur">EUR: <span id="EUFX"></span></p>
        </div>
    </main>
    
    <script src="js/jquery-3.2.1.min.js"></script>
    <script src="js/money.js"></script>
    <script type="text/javascript">
        // Load exchange rates data via AJAX:
        function convert() {
            //get the value to convert
            var stringToConvert = $('#amount').val();
            
            //Display the value to convert in #amount-entered
            $('#amount-entered').html("&pound;" + stringToConvert);
            //Display #desc-p
            $('#desc-p').fadeIn();
            
            $.getJSON(
                'https://openexchangerates.org/api/latest.json?app_id=49d329385faf437b9f7f75fbd5c5083d', //openexchangerates API
                function(data) {
                    // Check money.js has finished loading:
                    if ( typeof fx !== "undefined" && fx.rates ) {
                        fx.rates = data.rates;
                        fx.base = data.base;
                    } else {
                        // If not, apply to fxSetup global:
                        var fxSetup = {
                            rates : data.rates,
                            base : data.base
                        };
                    }
                    
                    //find all characters except £
                    var numb = stringToConvert.match(/[^£]/g);
                    //join the numbers together
                    numb = numb.join("");
                                
                    //convert the string numbers into actual data type numbers
                    numb = Number(numb);
                    
                    //do the conversions
                    var conversionUS = fx.convert(numb, {from: 'GBP', to: 'USD'});
                    var conversionEU = fx.convert(numb, {from: 'GBP', to: 'EUR'});
                    //round them to two decimal places
                    var roundedConversionUS = parseFloat(Math.round(conversionUS * 100) / 100).toFixed(2);
                    var roundedConversionEU = parseFloat(Math.round(conversionEU * 100) / 100).toFixed(2);
                                
                    //print the conversion onto the page
                    document.getElementById('USFX').innerHTML = '$' + roundedConversionUS;
                    document.getElementById('EUFX').innerHTML = '&euro;' + roundedConversionEU;
                    
                    //Display the conversion with animation
                    $('#usd').fadeIn(800);
                    $('#eur').fadeIn(800);
                }
            );
        }
    </script>
</body>
</html>